local Library = loadstring(Game:HttpGet("https://raw.githubusercontent.com/bloodball/-back-ups-for-libs/main/wizard"))()

local MainWindow = Library:NewWindow("Lemon V1.5.4")

local MainSection = MainWindow:NewSection("Main")
local ExtraSection = MainWindow:NewSection("Extra")

getgenv().AutoFarm = false
getgenv().KeyAutoFarm = false

local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local backpack = player:FindFirstChild("Backpack")
local humanoid = character:FindFirstChildOfClass("Humanoid")

local storages = workspace.Storages

local function StorageAutoFarm()
    while AutoFarm == true do
        for _, storage in pairs(storages:GetChildren()) do
            if AutoFarm == false then break end
                if storage:IsA("Model") then
                    local handle = storage.Door:FindFirstChild("Handle")
                    if handle then
                        character.HumanoidRootPart.CFrame = handle.CFrame
                        local prompt = handle:FindFirstChildWhichIsA("ProximityPrompt")
                        if prompt then
                        task.wait(0.5)
                        fireproximityprompt(prompt)
                        task.wait(1)
                            local contents = storage:FindFirstChild("Contents")
                            if contents then
                                local loot = contents:FindFirstChild("Loot")
                                if loot then
                                    for _, item in pairs(loot:GetDescendants()) do
                                        if item:IsA("ProximityPrompt") then
                                            if item.Parent:IsA("Part") or item.Parent:IsA("MeshPart") then
                                                character.HumanoidRootPart.CFrame = item.Parent.CFrame
                                                local Itemprompt = item
                                                if Itemprompt then
                                                wait(0.1)
                                                fireproximityprompt(Itemprompt)
                                                wait(0.2)
                                                end
                                            elseif item.Parent:IsA("Model") then
                                                character.HumanoidRootPart.CFrame = item.Parent.PrimaryPart.CFrame
                                                local Itemprompt = item
                                                if prompt then
                                                    wait(0.1)
                                                    fireproximityprompt(Itemprompt)
                                                    wait(0.2)
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
        end
        wait()
    end
end

local function equipSkeletonKey()
    if character and backpack then
        local skeletonKeyInCharacter = character:FindFirstChild("Skeleton Key")
        local skeletonKeyInBackpack = backpack:FindFirstChild("Skeleton Key")

        if not skeletonKeyInCharacter and skeletonKeyInBackpack and humanoid then
            humanoid:EquipTool(skeletonKeyInBackpack)
        elseif skeletonKeyInCharacter then
            print("Skeleton Key is already equipped.")
        else
            print("Skeleton Key not found in the backpack.")
        end
    else
        print("Character or Backpack not found.")
    end
end

local function KeyStorageAutoFarm()
    while KeyAutoFarm == true do
        for _, storage in pairs(storages:GetChildren()) do
            if KeyAutoFarm == false then break end
                if storage:IsA("Model") then
                    local handle = storage.Door:FindFirstChild("Handle")
                    if handle.Parent:FindFirstChild("Lock") then
                        character.HumanoidRootPart.CFrame = handle.CFrame
                        local prompt = handle:FindFirstChildWhichIsA("ProximityPrompt")
                        if prompt then
                        equipSkeletonKey()
                        task.wait(0.5)
                        fireproximityprompt(prompt)
                        task.wait(1)
                            local contents = storage:FindFirstChild("Contents")
                            if contents then
                                local loot = contents:FindFirstChild("Loot")
                                if loot then
                                    for _, item in pairs(loot:GetDescendants()) do
                                        if item:IsA("ProximityPrompt") then
                                            if item.Parent:IsA("Part") or item.Parent:IsA("MeshPart") then
                                                character.HumanoidRootPart.CFrame = item.Parent.CFrame
                                                local Itemprompt = item
                                                if Itemprompt then
                                                wait(0.1)
                                                fireproximityprompt(Itemprompt)
                                                wait(0.2)
                                                end
                                            elseif item.Parent:IsA("Model") then
                                                character.HumanoidRootPart.CFrame = item.Parent.PrimaryPart.CFrame
                                                local Itemprompt = item
                                                if prompt then
                                                    wait(0.1)
                                                    fireproximityprompt(Itemprompt)
                                                    wait(0.2)
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
        end
        wait()
    end
end

local function SafePlace()
    if game.Workspace:FindFirstChild("SkyPlaceThatIsCool") then
        print("Safe Spot is already there!")
    else
        local skyPart = Instance.new("Part")

        skyPart.Name = "SkyPlaceThatIsCool"
        skyPart.Size = Vector3.new(50, 1, 50) -- Size of the part
        skyPart.Position = Vector3.new(0, 100, 0) -- Position in the sky
        skyPart.Anchored = true -- Make sure the part doesn't fall
        skyPart.BrickColor = BrickColor.new("Bright blue") -- Color of the part
        skyPart.Transparency = 0.4
        skyPart.Parent = game.Workspace
    end
end

SafePlace()

MainSection:CreateToggle("AutoFarm", function(value)
    AutoFarm = value
    StorageAutoFarm()
end)

MainSection:CreateToggle("Key AutoFarm", function(value)
    KeyAutoFarm = value
    KeyStorageAutoFarm()
end)

MainSection:CreateButton("Safe Spot", function()
    character.HumanoidRootPart.CFrame = CFrame.new(0, 105.5, 0)
end)

MainSection:CreateButton("Debug", function()
    loadstring(game:HttpGet('https://raw.githubusercontent.com/L3monnn/RobloxScripts/Games/TheStorage'))()
end)
